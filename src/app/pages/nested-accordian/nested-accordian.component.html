<div class="">
    <mat-accordion multi="true">

        <!-- Outer Expansion Panel -->
        <mat-expansion-panel [ngClass]="getPanelClass(-1)" showToggle="true">
            <mat-expansion-panel-header>
                Outer Expansion Panel
            </mat-expansion-panel-header>

            <ng-template matExpansionPanelContent>
                <mat-accordion class="example-headers-align" multi="true">
                    @for (middleItem of middleItems; track middleItem; let mp = $index) {

                    <!-- Middle Expansion Panel -->
                    <mat-expansion-panel [ngClass]="getPanelClass(mp)" (opened)="setMiddleStep(mp)" showToggle="true">

                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                Middle Panel {{ middleItem }}
                            </mat-panel-title>
                        </mat-expansion-panel-header>

                        <ng-template matExpansionPanelContent>
                            <mat-accordion class="example-headers-align" multi="true">
                                @for (innerItem of innerItems; track innerItem; let ip = $index) {

                                <!-- Inner Expansion Panel -->
                                <mat-expansion-panel [ngClass]="getPanelClass(ip, mp)" (opened)="setInnerStep(ip)" showToggle="true">

                                    <mat-expansion-panel-header>
                                        <mat-panel-title>
                                            Inner Panel {{ innerItem }}
                                        </mat-panel-title>
                                    </mat-expansion-panel-header>

                                    <ng-template matExpansionPanelContent>
                                       <div class="mt-3">
                                       <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Odio sed sequi doloribus excepturi ipsum accusamus facilis, at enim velit, quos quaerat, odit commodi repellat debitis optio unde! Accusantium eligendi facilis quisquam repellat, praesentium quis nulla cum neque obcaecati, porro, ipsa quidem. Nulla, velit impedit quasi exercitationem quos ratione vitae voluptate. Laudantium iste ut debitis vel vero recusandae sint sed quae non nam. Quia excepturi cumque, fugiat illo esse voluptatum magnam repellat tenetur in eaque fuga culpa aspernatur, adipisci optio et dolorum temporibus? Tenetur numquam ipsam, consequuntur repellendus nulla quaerat repellat praesentium unde illo id, suscipit neque vero animi perspiciatis officiis.</p>
                                       </div>
                                    </ng-template>

                                </mat-expansion-panel>

                                }
                            </mat-accordion>
                        </ng-template>
                    </mat-expansion-panel>

                    }
                </mat-accordion>
            </ng-template>
        </mat-expansion-panel>

    </mat-accordion>
</div>
